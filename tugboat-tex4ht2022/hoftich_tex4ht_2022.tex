% This template file is public domain.
%
% TUGboat class documentation is at:
%   http://mirrors.ctan.org/macros/latex/contrib/tugboat/ltubguid.pdf
% or
%   texdoc tugboat

\documentclass{ltugboat}

\usepackage{microtype}
\usepackage{graphicx}
\usepackage[hidelinks,pdfa]{hyperref}

%%% Start of metadata %%%

\title{What's new in \TeX4ht}

% repeat info for each author; comment out items that don't apply.
\author{Michal Hoftich}
\EDITORnoaddress
% Bellu≈°ova 1829, Prague 5, 155 00
\netaddress{michal.h21@gmail.com}
\personalURL{https://www.kodymirus.cz/}
%\ORCID{0}
% To receive a physical copy of the TUGboat issue, please include the
% mailing address we should use, as a comment if you prefer it not be printed.


%%% End of metadata %%%

\newcommand\makefourht{\texttt{make4ht}}

\begin{document}
\maketitle

\begin{abstract}
  % ToDo: write abstract
\end{abstract}

\section{Introduction}

Richard Koch wrote an article on interactive documents produced using
\TeX4ht in this issue of \TUB. He and Karl Berry asked me if I wanted 
to provide additional tips for usage of \TeX4ht, and also to summarize
the recent changes in the system.


\hypertarget{Whatux27sux20newux20inux20TeX4ht}{%
\section{What's new in TeX4ht}\label{Whatux27sux20newux20inux20TeX4ht}}

You can find the basic summary of the basic \TeX4ht features in my previous article
\cite{Hoftich:2019:TLW}. I will focus on the new features and changes in this section.

\subsection{New features in \makefourht}

There are some substantial changes in \makefourht\ build system. These are the
most important:

\subsubsection{Terminal output}

Originally, \makefourht\ showed full terminal output from \TeX\ and all
commands that it called in the process of conversion. It resulted in a huge 
amount of information printed to the terminal. It also used the default 
behavior of \LaTeX, so the compilation was stopped on every error, waiting
for the user action.

The new default behaviour is to run the compilation in the non-stop mode, 
with most of the terminal output suppressed. Only errors and warnings are 
shown. 

You can change the output method using a new command line option,
\verb|--loglevel|, or \verb|-a| in the short form. Each log level prints 
messages of the current level and all higher levels.
It supports the following levels:

\begin{description}
  \item[error] -- print only error messages
  \item[warning] -- show \makefourht\ warnings, for example from HTML post-processing filters
  \item[status] -- this is the default level 
  \item[info]  -- print all \makefourht\ messages, but suppress output from commands
  \item[debug] -- this level is the original default, it prints output of
    \TeX\ and all other executed programs, it also stops on compilation
    errors.
\end{description}

\subsubsection{Input redirection}

\makefourht\ now supports shell input redirection, which means that it can 
process output from other commands without the need to use temporary files.
You need to pass \verb|-| as a filename, and also set the output filename using
the \verb|--jobname| or \verb|-j| option:

\begin{verbatim}
$ python generatetex.py | make4ht -j foo -
\end{verbatim}



\subsection{Conversion of additional markup languages}

In addition to \LaTeX\ and Plain\TeX, \makefourht\ supports some additional
markup languages, thanks to the \verb|preprocess_input| extension. 
It detects the used markup using the file extension, so it is necessary
to name the file accordingly. It pre-processes the input using Pandoc or R with
the Knitr library, which needs to be installed on your system.

The list of supported file extensions is following:

\begin{description}
  \item[rtex] -- \LaTeX\ with R code chunks
  \item[rnw] -- \LaTeX\ with the Sweave code chunks
  \item[rmd] -- RMarkdown
  \item[rrst] -- R + reStructuredText
  \item[md] -- Markdown
  \item[rst] -- reStructuredText
\end{description}

For example, the following sample contains R\TeX\ document:

\begin{verbatim}
\documentclass{article}
\begin{document}

You can type R commands in your \LaTeX{} 
document which will be processed and
their output included in the document:

<<>>=
# Create a sequence of numbers
X = 2:10

# Display basic statistical measures
summary(X)

@
\end{document}
\end{verbatim}

You can compile it with the following command, which loads
the \verb|preprocess_input| extension:

\begin{verbatim}
$ make4ht -f html5+preprocess_input x.rtex
\end{verbatim}

\subsection{New commands available in build files}

You can use Lua build files to call additional commands like indexing and
bibliography processors with \makefourht. There are now built-in
commands for Biber, \BibTeX, Makeindex, Xindy, Xindex and PythonTeX. They 
take care of special settings necessary to work correctly with \TeX4ht.

As an example, the following sample file should produce an index with links 
that point to the place where \verb|\index| were used:

\begin{verbatim}
\documentclass{article} 
\usepackage{makeidx} 
\makeindex 
\begin{document} 
Hello\index{hello} 
world\index{world} 
\printindex 
\end{document}
\end{verbatim}

The build file, that uses Makeindex as an indexing processor can look like this:

\begin{verbatim}
Make:htlatex {} 
Make:makeindex {} 
Make:htlatex{}
\end{verbatim}

The \verb|Make:htlatex| command compiles the document using \LaTeX\ with 
the \TeX4ht package automatically loaded, \verb|Make:makeindex| calls 
Makeindex and the final \verb|Make:htlatex| will compile document with 
the index included. Note that instead of page numbers, numbers in the index
are numbered consecutively for each \verb|\index| command. Thanks to that,
we can point every index entry back to the original location.

To use a build file, use the \verb|-e| command line option:

\begin{verbatim}
$ make4ht -e build.lua foo.tex
\end{verbatim}

\section{Documentation and server side compilation}

Thanks to the 

\tbsurl{www.kodymirus.cz/tex4ht-doc}

%- support for shell pipes
%  - --jobname
%- preprocess_input


\subsection{JATS output}

We recently added a support for the JATS XML format, which is intended for 
scientific articles authoring. 



\begin{itemize}

\item make4ht extensions:
  
\item JATS export
\item documentation at kodymirus.cz
\item server side compilation:
  \begin{itemize}
  \item siterebuild
  \item testblog
  \end{itemize}

\item LaTeX kernel updates
\item handling of catcode issues in packages
  \begin{itemize}
  \item \textbackslash SUBOff and \textbackslash SUBOn in usepackage.4ht
    \url{https://tug.org/pipermail/tex4ht-commits/2022q3/001185.html}
  \end{itemize}
\item Math processing:
  \begin{itemize}
  \item make4ht options:
    \begin{itemize}
    \item mathml
    \item mathjax
      \begin{itemize}
      \item configuration
      \item loading of custom commands
      \item cross-referencing support
      \end{itemize}
    \end{itemize}
  \item MathJax mode
    \begin{itemize}
    \item mathml rendering
    \item LaTeX rendering
    \item
      new node.js compilation - \texttt{mjcli}
      \url{https://github.com/michal-h21/mjcli}
    \end{itemize}
  \end{itemize}
\item HTF fonts
\item command and package fixes

  \begin{itemize}
  \item robust commands and issues with TOC and list of figures, captions
    etc.
  \end{itemize}
\end{itemize}



% verbatim blocks are often better in \small
\begin{verbatim}[\small]
\AllTeX \AMS
\BibTeX \Cplusplus \CTAN
\DVI
\HTML \LaTeXe
\MacOSX \MathML \MF
\PDF \PS
\TUB \TUG \tug
\WEB
\XeLaTeX \XeTeX \XML

\Dash \slash

\acro{FRED} -> {\small[er] FRED}  % please use!
\cs{fred}   -> \fred
\meta{fred} -> <fred>
\booktitle{Book of Fred}
\end{verbatim}


\bibliographystyle{tugboat}
\nocite{book-minimal}      % make the bibliography non-empty
\bibliography{tugboat}

\makesignature
\end{document}
